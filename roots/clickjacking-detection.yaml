id: clickjacking-detection

info:
  name: Clickjacking Vulnerability Detection
  author: Vulnpire
  severity: medium
  description: |
    Detects the presence of a Clickjacking vulnerability by checking if a webpage can be embedded within an iframe. 
    The absence of X-Frame-Options or an insecure Content-Security-Policy header can allow attackers to embed the webpage in an iframe, potentially leading to clickjacking attacks.
  tags: clickjacking, web, security

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        part: header
        words:
          - "X-Frame-Options"
        condition: and
        negative: true
        name: Missing X-Frame-Options

      - type: regex
        part: header
        regex:
          - "Content-Security-Policy:.*frame-ancestors"
        condition: and
        negative: true
        name: Missing or insecure frame-ancestors in Content-Security-Policy

    extractors:
      - type: regex
        part: body
        name: page-title
        regex:
          - "<title>([^<]+)</title>"
